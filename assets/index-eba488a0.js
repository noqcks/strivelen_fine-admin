var P=Object.defineProperty;var U=(t,e,o)=>e in t?P(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o;var u=(t,e,o)=>(U(t,typeof e!="symbol"?e+"":e,o),o);import{A as b,j as i,c as C,a as l,b as v,P as S,d as A,p,e as m,f as M,g as O,F as j,R as E,h as x,i as D,k as F,u as $,r as B,C as g,t as N,l as q,m as z,n as G,o as H,z as K}from"./vendor-b1db58c8.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function o(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(s){if(s.ep)return;s.ep=!0;const n=o(s);fetch(s.href,n)}})();let h;function W(){const t=b.useApp();h=t.message,t.modal,t.notification}function J(){return W(),i("h1",{children:"测试 CI"})}function Y(t=1){return new Promise(e=>setTimeout(()=>e({data:t}),500))}const _={value:2,status:"idle"},f=C("counter/fetchCount",async t=>(await Y(t)).data),Q=l({name:"counter",initialState:_,reducers:{increment:t=>{t.value+=1},decrement:t=>{t.value-=1},incrementByAmount:(t,e)=>{t.value+=e.payload}},extraReducers:t=>{t.addCase(f.pending,e=>{e.status="loading"}).addCase(f.fulfilled,(e,o)=>{e.status="idle",e.value+=o.payload}).addCase(f.rejected,e=>{e.status="failed"})}}),V=Q.reducer,c={app:{name:"后台管理系统"},api:{baseUrl:"https://www.fastmock.site/mock/d6f0134049a0e22b01d7aae6fafc9045/api",timeout:3e4,sessionKey:"sessionkey",status:{200:"请求成功",401:"未授权，请重新登录",403:"拒绝访问",404:"请求错误，未找到该资源",408:"请求超时",500:"服务器发生错误",501:"服务未实现",502:"网络错误",503:"服务不可用",504:"网络超时",505:"HTTP版本不受支持"}},pageSize:20,themeColors:["#1677ff","#ee3f4d","#c08eaf","#95509f","#722ed1","#00b96b","#7cb305","#13c2c2","#d6a01d"],fixedWidth:1200};function X(t,e){const o=document.createElement("a");o.href=t,o.download=e,document.body.appendChild(o),o.click(),document.body.removeChild(o)}function Z(t,e="",o){let r=new Blob([t],{type:o});const s=window.URL.createObjectURL(r);X(s,e),window.URL.revokeObjectURL(s)}class ee{constructor(e={}){u(this,"instance");u(this,"baseConfig",{baseURL:c.api.baseUrl,timeout:c.api.timeout});this.instance=v.create(Object.assign(this.baseConfig,e)),this.instance.interceptors.request.use(o=>{const r=re(d.getState());return r&&(o.headers[c.api.sessionKey]=r),o},o=>Promise.reject(o)),this.instance.interceptors.response.use(o=>{var n;const{headers:r,data:s}=o;if((n=r["content-type"])!=null&&n.includes("application/json")&&s.Code!==200){const a=s.Message||c.api.status[s.Code]||"HTTP响应错误";return s.Code===401&&I.purge(),h.error(a),Promise.reject(a)}return o},o=>(h.error(`${o.message}, 请检查网络或联系管理员`),Promise.reject(o)))}get(e,o){return this.instance.get(e,o).then(({data:r})=>r.Data)}post(e,o,r){return this.instance.post(e,o,r).then(({data:s})=>s.Data)}getBlob(e,o,r){return this.post(e,o,{responseType:"blob",...r}).then(s=>{const{data:n,headers:a}=s,w=a["content-type"],L=a["content-disposition"].split("=")[1];return{blob:n,filename:decodeURIComponent(L),fileType:w}})}async getStreamFileToDownload(e,o,r){const{blob:s,filename:n,fileType:a}=await this.getBlob(e,o,r);return Z(s,n,a),{blob:s,filename:n,fileType:a}}request(e){return this.instance.request(e).then(o=>o.data)}}const k=new ee,te=async t=>k.post("/User/Login",t),oe=()=>k.get("/User/Get"),se={userInfo:{},token:void 0,isLogin:!1},y=C("user/fetchLogin",async t=>await te(t)),R=l({name:"user",initialState:se,reducers:{setToken:(t,e)=>{t.token=e.payload},setUserInfo:(t,e)=>{t.userInfo=e.payload}},extraReducers:t=>{t.addCase(y.fulfilled,(e,o)=>{const{UserInfo:r,SessionKey:s,MenuItems:n=[]}=o.payload;e.userInfo=r,e.token=s,e.isLogin=!0}).addCase(y.rejected,e=>{e.isLogin=!1}).addCase(S,e=>{e.userInfo={},e.token=void 0,e.isLogin=!1})}}),{setToken:Te,setUserInfo:ne}=R.actions,re=t=>t.user.token,ae=R.reducer,ie={layoutMode:"sidemenu",collapsed:!1,breadcrumb:["首页"],isDarkMode:!1,themeColor:"#1677ff",isOpenSetting:!1,isFixedWidth:!1},ce=l({name:"layout",initialState:ie,reducers:{setLayoutMode:(t,e)=>{t.layoutMode=e.payload},setBreadcrumb:(t,e)=>{t.breadcrumb=e.payload},setCollapsed:(t,e)=>{t.collapsed=e.payload},setDarkMode:(t,e)=>{t.isDarkMode=e.payload},setThemeColor:(t,e)=>{t.themeColor=e.payload},setIsOpenSetting:(t,e)=>{t.isOpenSetting=e.payload},setIsFixedWidth:(t,e)=>{t.isFixedWidth=e.payload}}}),le=t=>t.layout.isDarkMode,de=t=>t.layout.themeColor,ue=ce.reducer,fe={loading:!1},pe=l({name:"loading",initialState:fe,reducers:{setLoading:(t,e)=>{t.loading=e.payload}}}),me=pe.reducer,he=A({loading:me,counter:V,user:p({key:"user",storage:m,blacklist:["status"]},ae),layout:p({key:"layout",storage:m},ue)}),ge={key:"root",version:1,storage:m,blacklist:["user","layout","counter","loading"]},ye=p(ge,he),d=M({reducer:ye,middleware:t=>t({serializableCheck:{ignoredActions:[j,E,x,D,S,F]}})}),I=O(d),T=$,be=async function(){if(!JSON.parse(localStorage.getItem("persist:user")||"{}").token)return;const e=await oe();d.dispatch(ne(e))},{darkAlgorithm:Ce}=N;function Se({children:t}){const e=T(le);return B.useEffect(()=>{document.body.className=e?"dark":""},[e]),i(g,{theme:{algorithm:e?[Ce]:void 0},children:t})}function ke({children:t}){const e=T(de);return i(g,{theme:{token:{colorPrimary:e}},children:t})}q.locale("zh-cn");be();z.createRoot(document.getElementById("root")).render(i(G,{store:d,children:i(H,{loading:null,persistor:I,children:i(Se,{children:i(ke,{children:i(g,{locale:K,input:{autoComplete:"off"},children:i(b,{children:i(J,{})})})})})})}));
